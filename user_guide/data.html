

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Specifying Data in Altair &mdash; Altair 4.1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/altair-plot.css" type="text/css" />
  <link rel="stylesheet" href="../_static/altair-gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Encodings" href="encoding.html" />
    <link rel="prev" title="Wilkinson Dot Plot" href="../gallery/wilkinson-dot-plot.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Altair
          

          
            
            <img src="../_static/altair-logo-light.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                4.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html#development-install">Development Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/starting.html">Basic Statistical Visualization</a></li>
</ul>
<p class="caption"><span class="caption-text">Gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Example Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Specifying Data in Altair</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#including-index-data">Including Index Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#long-form-vs-wide-form-data">Long-form vs. Wide-form Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#converting-between-long-form-and-wide-form-pandas">Converting Between Long-form and Wide-form: Pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#converting-between-long-form-and-wide-form-fold-transform">Converting Between Long-form and Wide-form: Fold Transform</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#generated-data">Generated Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sequence-generator">Sequence Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#graticule-generator">Graticule Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sphere-generator">Sphere Generator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#geospatial-data">Geospatial Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#geopandas-vs-pandas">GeoPandas vs Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#projections">Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#winding-order">Winding order</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="encoding.html">Encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="marks.html">Marks</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform/index.html">Data Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactions.html">Bindings, Selections, Conditions: Making Charts Interactive</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Top-Level Chart Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="compound_charts.html">Compound Charts: Layer, HConcat, VConcat, Repeat, Facet</a></li>
<li class="toctree-l1"><a class="reference internal" href="scale_resolve.html">Scale and Guide Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="saving_charts.html">Saving Altair Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="customization.html">Customizing Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="times_and_dates.html">Times and Dates in Altair</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Display Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Altair Internals: Understanding the Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecosystem.html">Altair Ecosystem</a></li>
</ul>
<p class="caption"><span class="caption-text">Case Studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../case_studies/exploring-weather.html">Exploring Seattle Weather</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="importing.html">Importing Vega &amp; Vega-Lite Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="display_frontends.html">Displaying Altair Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="display_frontends.html#renderer-api">Renderer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_renderers.html">Customizing Renderers</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_transformers.html">Data transformers</a></li>
</ul>
<p class="caption"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../releases/changes.html">Altair Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Altair</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Specifying Data in Altair</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user_guide/data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="specifying-data-in-altair">
<span id="user-guide-data"></span><h1>Specifying Data in Altair<a class="headerlink" href="#specifying-data-in-altair" title="Permalink to this headline">Â¶</a></h1>
<p>Each top-level chart object (i.e. <a class="reference internal" href="generated/toplevel/altair.Chart.html#altair.Chart" title="altair.Chart"><code class="xref py py-class docutils literal"><span class="pre">Chart</span></code></a>, <a class="reference internal" href="generated/toplevel/altair.LayerChart.html#altair.LayerChart" title="altair.LayerChart"><code class="xref py py-class docutils literal"><span class="pre">LayerChart</span></code></a>,
and <a class="reference internal" href="generated/toplevel/altair.VConcatChart.html#altair.VConcatChart" title="altair.VConcatChart"><code class="xref py py-class docutils literal"><span class="pre">VConcatChart</span></code></a>, <a class="reference internal" href="generated/toplevel/altair.HConcatChart.html#altair.HConcatChart" title="altair.HConcatChart"><code class="xref py py-class docutils literal"><span class="pre">HConcatChart</span></code></a>, <a class="reference internal" href="generated/toplevel/altair.RepeatChart.html#altair.RepeatChart" title="altair.RepeatChart"><code class="xref py py-class docutils literal"><span class="pre">RepeatChart</span></code></a>,
<a class="reference internal" href="generated/toplevel/altair.FacetChart.html#altair.FacetChart" title="altair.FacetChart"><code class="xref py py-class docutils literal"><span class="pre">FacetChart</span></code></a>) accepts a dataset as its first argument.
The dataset can be specified in one of the following ways:</p>
<ul class="simple">
<li>as a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">Pandas DataFrame</a></li>
<li>as a <a class="reference internal" href="generated/core/altair.Data.html#altair.Data" title="altair.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a> or related object (i.e. <a class="reference internal" href="generated/core/altair.UrlData.html#altair.UrlData" title="altair.UrlData"><code class="xref py py-class docutils literal"><span class="pre">UrlData</span></code></a>, <a class="reference internal" href="generated/core/altair.InlineData.html#altair.InlineData" title="altair.InlineData"><code class="xref py py-class docutils literal"><span class="pre">InlineData</span></code></a>, <a class="reference internal" href="generated/core/altair.NamedData.html#altair.NamedData" title="altair.NamedData"><code class="xref py py-class docutils literal"><span class="pre">NamedData</span></code></a>)</li>
<li>as a url string pointing to a <code class="docutils literal"><span class="pre">json</span></code> or <code class="docutils literal"><span class="pre">csv</span></code> formatted text file</li>
<li>as an object that supports the <cite>__geo_interface__</cite> (eg. <a class="reference external" href="http://geopandas.org/data_structures.html#geodataframe">Geopandas GeoDataFrame</a>, <a class="reference external" href="https://shapely.readthedocs.io/en/latest/manual.html#geometric-objects">Shapely Geometries</a>, <a class="reference external" href="https://github.com/jazzband/geojson#geojson-objects">GeoJSON Objects</a>)</li>
</ul>
<p>For example, here we specify data via a DataFrame:</p>
<div class="highlight-python" id="data-rst-altair-source-0"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-0">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-865b0f7f64bff0a4a97037244e6476d1"}, "mark": "bar", "encoding": {"x": {"type": "nominal", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-865b0f7f64bff0a4a97037244e6476d1": [{"x": "A", "y": 5}, {"x": "B", "y": 3}, {"x": "C", "y": 6}, {"x": "D", "y": 7}, {"x": "E", "y": 2}]}};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-0', spec, opt).catch(console.err);
  });
</script>
</div><p>When data is specified as a DataFrame, the encoding is quite simple, as Altair
uses the data type information provided by Pandas to automatically determine
the data types required in the encoding.</p>
<p>By comparison, here we create the same chart using a <a class="reference internal" href="generated/core/altair.Data.html#altair.Data" title="altair.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a> object,
with the data specified as a JSON-style list of records:</p>
<div class="highlight-python" id="data-rst-altair-source-1"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}])</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x:O&#39;</span><span class="p">,</span>  <span class="c1"># specify ordinal data</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y:Q&#39;</span><span class="p">,</span>  <span class="c1"># specify quantitative data</span>
<span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-1">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"values": [{"x": "A", "y": 5}, {"x": "B", "y": 3}, {"x": "C", "y": 6}, {"x": "D", "y": 7}, {"x": "E", "y": 2}]}, "mark": "bar", "encoding": {"x": {"type": "ordinal", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json"};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-1', spec, opt).catch(console.err);
  });
</script>
</div><p>notice the extra markup required in the encoding; because Altair cannot infer
the types within a <a class="reference internal" href="generated/core/altair.Data.html#altair.Data" title="altair.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a> object, we must specify them manually
(here we use <a class="reference internal" href="encoding.html#shorthand-description"><span class="std std-ref">Encoding Shorthands</span></a> to specify <em>ordinal</em> (<code class="docutils literal"><span class="pre">O</span></code>) for <code class="docutils literal"><span class="pre">x</span></code>
and <em>quantitative</em> (<code class="docutils literal"><span class="pre">Q</span></code>) for <code class="docutils literal"><span class="pre">y</span></code>; see <a class="reference internal" href="encoding.html#encoding-data-types"><span class="std std-ref">Encoding Data Types</span></a>).</p>
<p>Similarly, we must also specify the data type when referencing data by URL:</p>
<div class="highlight-python" id="data-rst-altair-source-2"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">from</span> <span class="nn">vega_datasets</span> <span class="kn">import</span> <span class="n">data</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cars</span><span class="o">.</span><span class="n">url</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Horsepower:Q&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Miles_per_Gallon:Q&#39;</span>
<span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-2">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"url": "https://cdn.jsdelivr.net/npm/vega-datasets@v1.29.0/data/cars.json"}, "mark": "point", "encoding": {"x": {"type": "quantitative", "field": "Horsepower"}, "y": {"type": "quantitative", "field": "Miles_per_Gallon"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json"};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-2', spec, opt).catch(console.err);
  });
</script>
</div><p>We will further discuss encodings and associated types in <a class="reference internal" href="encoding.html#user-guide-encoding"><span class="std std-ref">Encodings</span></a>, next.</p>
<div class="section" id="including-index-data">
<span id="data-in-index"></span><h2>Including Index Data<a class="headerlink" href="#including-index-data" title="Permalink to this headline">Â¶</a></h2>
<p>By design Altair only accesses dataframe columns, not dataframe indices.
At times, relevant data appears in the index. For example:</p>
<div class="highlight-python" id="data-rst-altair-source-3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">rand</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()},</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>                   value
    2018-01-01  1.764052
    2018-01-02  2.164210
    2018-01-03  3.142948
    2018-01-04  5.383841
    2018-01-05  7.251399
</pre></div>
</div>
<p>If you would like the index to be available to the chart, you can explicitly
turn it into a column using the <code class="docutils literal"><span class="pre">reset_index()</span></code> method of Pandas dataframes:</p>
<div class="highlight-python" id="data-rst-altair-source-4"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;index:T&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value:Q&#39;</span>
<span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-4">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-dd19c1c673ba91c82c2873cf9b033163"}, "mark": "line", "encoding": {"x": {"type": "temporal", "field": "index"}, "y": {"type": "quantitative", "field": "value"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-dd19c1c673ba91c82c2873cf9b033163": [{"index": "2018-01-01T00:00:00", "value": 1.764052345967664}, {"index": "2018-01-02T00:00:00", "value": 2.1642095543348874}, {"index": "2018-01-03T00:00:00", "value": 3.1429475384406267}, {"index": "2018-01-04T00:00:00", "value": 5.3838407376420845}, {"index": "2018-01-05T00:00:00", "value": 7.251398727792052}, {"index": "2018-01-06T00:00:00", "value": 6.274120847915642}, {"index": "2018-01-07T00:00:00", "value": 7.224209265441231}, {"index": "2018-01-08T00:00:00", "value": 7.072852057143533}, {"index": "2018-01-09T00:00:00", "value": 6.969633205349975}, {"index": "2018-01-10T00:00:00", "value": 7.380231707288347}, {"index": "2018-01-11T00:00:00", "value": 7.524275278449225}, {"index": "2018-01-12T00:00:00", "value": 8.9785487854122}, {"index": "2018-01-13T00:00:00", "value": 9.739586510559192}, {"index": "2018-01-14T00:00:00", "value": 9.86126152705202}, {"index": "2018-01-15T00:00:00", "value": 10.305124759797446}, {"index": "2018-01-16T00:00:00", "value": 10.638799087171712}, {"index": "2018-01-17T00:00:00", "value": 12.132878160329318}, {"index": "2018-01-18T00:00:00", "value": 11.927719896563516}, {"index": "2018-01-19T00:00:00", "value": 12.240787598214418}, {"index": "2018-01-20T00:00:00", "value": 11.386691858912693}, {"index": "2018-01-21T00:00:00", "value": 8.833702043078613}, {"index": "2018-01-22T00:00:00", "value": 9.487320638518973}, {"index": "2018-01-23T00:00:00", "value": 10.35175683737848}, {"index": "2018-01-24T00:00:00", "value": 9.609591816972037}, {"index": "2018-01-25T00:00:00", "value": 11.879346440959644}, {"index": "2018-01-26T00:00:00", "value": 10.424980766360878}, {"index": "2018-01-27T00:00:00", "value": 10.470739283662324}, {"index": "2018-01-28T00:00:00", "value": 10.28355543363649}, {"index": "2018-01-29T00:00:00", "value": 11.816334647994948}, {"index": "2018-01-30T00:00:00", "value": 13.285693417895233}, {"index": "2018-01-31T00:00:00", "value": 13.44064084359215}, {"index": "2018-02-01T00:00:00", "value": 13.818803363194323}, {"index": "2018-02-02T00:00:00", "value": 12.93101761556421}, {"index": "2018-02-03T00:00:00", "value": 10.950221147340283}, {"index": "2018-02-04T00:00:00", "value": 10.60230899801413}, {"index": "2018-02-05T00:00:00", "value": 10.758657967118111}, {"index": "2018-02-06T00:00:00", "value": 11.988948647845833}, {"index": "2018-02-07T00:00:00", "value": 13.191328496630245}, {"index": "2018-02-08T00:00:00", "value": 12.804001679222292}, {"index": "2018-02-09T00:00:00", "value": 12.501698928646956}, {"index": "2018-02-10T00:00:00", "value": 11.453145963579864}, {"index": "2018-02-11T00:00:00", "value": 10.033128026400888}, {"index": "2018-02-12T00:00:00", "value": 8.326857835775876}, {"index": "2018-02-13T00:00:00", "value": 10.277633231007666}, {"index": "2018-02-14T00:00:00", "value": 9.767981049256013}, {"index": "2018-02-15T00:00:00", "value": 9.329906747644827}, {"index": "2018-02-16T00:00:00", "value": 8.0771113875949}, {"index": "2018-02-17T00:00:00", "value": 8.85460174342681}, {"index": "2018-02-18T00:00:00", "value": 7.240703895868859}, {"index": "2018-02-19T00:00:00", "value": 7.02796361565489}, {"index": "2018-02-20T00:00:00", "value": 6.132497054461215}, {"index": "2018-02-21T00:00:00", "value": 6.519399552320477}, {"index": "2018-02-22T00:00:00", "value": 6.008594414751604}, {"index": "2018-02-23T00:00:00", "value": 4.827962230629192}, {"index": "2018-02-24T00:00:00", "value": 4.799780002290537}, {"index": "2018-02-25T00:00:00", "value": 5.228111872820954}, {"index": "2018-02-26T00:00:00", "value": 5.294629095204122}, {"index": "2018-02-27T00:00:00", "value": 5.597100992943904}, {"index": "2018-02-28T00:00:00", "value": 4.962778899262941}, {"index": "2018-03-01T00:00:00", "value": 4.600037733275802}, {"index": "2018-03-02T00:00:00", "value": 3.927577285499851}, {"index": "2018-03-03T00:00:00", "value": 3.56802412395931}, {"index": "2018-03-04T00:00:00", "value": 2.7548778419148556}, {"index": "2018-03-05T00:00:00", "value": 1.0285952395831788}, {"index": "2018-03-06T00:00:00", "value": 1.2060213818369316}, {"index": "2018-03-07T00:00:00", "value": 0.8042404456286698}, {"index": "2018-03-08T00:00:00", "value": -0.8259579013373748}, {"index": "2018-03-09T00:00:00", "value": -0.3631756458116006}, {"index": "2018-03-10T00:00:00", "value": -1.2704740101948429}, {"index": "2018-03-11T00:00:00", "value": -1.218528614398704}, {"index": "2018-03-12T00:00:00", "value": -0.4894380522211671}, {"index": "2018-03-13T00:00:00", "value": -0.36045514146375646}, {"index": "2018-03-14T00:00:00", "value": 0.7789455430795442}, {"index": "2018-03-15T00:00:00", "value": -0.4558802772741084}, {"index": "2018-03-16T00:00:00", "value": -0.0535386360965594}, {"index": "2018-03-17T00:00:00", "value": -0.7383487270368726}, {"index": "2018-03-18T00:00:00", "value": -1.6091458762187543}, {"index": "2018-03-19T00:00:00", "value": -2.1879955409831697}, {"index": "2018-03-20T00:00:00", "value": -2.4995480731105424}, {"index": "2018-03-21T00:00:00", "value": -2.443382730880797}, {"index": "2018-03-22T00:00:00", "value": -3.6085325716641536}, {"index": "2018-03-23T00:00:00", "value": -2.7077060847099665}, {"index": "2018-03-24T00:00:00", "value": -2.242043644979507}, {"index": "2018-03-25T00:00:00", "value": -3.7782873312567307}, {"index": "2018-03-26T00:00:00", "value": -2.290035137461131}, {"index": "2018-03-27T00:00:00", "value": -0.3941459614305478}, {"index": "2018-03-28T00:00:00", "value": 0.7846336097291029}, {"index": "2018-03-29T00:00:00", "value": 0.604708773916752}, {"index": "2018-03-30T00:00:00", "value": -0.4660438475937905}, {"index": "2018-03-31T00:00:00", "value": 0.5884078793373462}, {"index": "2018-04-01T00:00:00", "value": 0.18523093236416655}, {"index": "2018-04-02T00:00:00", "value": 1.407676002746594}, {"index": "2018-04-03T00:00:00", "value": 1.6159509808234542}, {"index": "2018-04-04T00:00:00", "value": 2.5925900173071668}, {"index": "2018-04-05T00:00:00", "value": 2.9489564144815685}, {"index": "2018-04-06T00:00:00", "value": 3.6555295826735166}, {"index": "2018-04-07T00:00:00", "value": 3.666029603394337}, {"index": "2018-04-08T00:00:00", "value": 5.4519000973001726}, {"index": "2018-04-09T00:00:00", "value": 5.578812190003792}, {"index": "2018-04-10T00:00:00", "value": 5.980801553448494}]}};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-4', spec, opt).catch(console.err);
  });
</script>
</div><p>If the index object does not have a <code class="docutils literal"><span class="pre">name</span></code> attribute set, the resulting
column will be called <code class="docutils literal"><span class="pre">&quot;index&quot;</span></code>.
More information is available in the
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.reset_index.html">Pandas documentation</a>.</p>
</div>
<div class="section" id="long-form-vs-wide-form-data">
<span id="data-long-vs-wide"></span><h2>Long-form vs. Wide-form Data<a class="headerlink" href="#long-form-vs-wide-form-data" title="Permalink to this headline">Â¶</a></h2>
<p>There are two common conventions for storing data in a dataframe, sometimes called
<em>long-form</em> and <em>wide-form</em>. Both are sensible patterns for storing data in
a tabular format; briefly, the difference is this:</p>
<ul class="simple">
<li><strong>wide-form data</strong> has one row per <em>independent variable</em>, with metadata
recorded in the <em>row and column labels</em>.</li>
<li><strong>long-form data</strong> has one row per <em>observation</em>, with metadata recorded
within the table as <em>values</em>.</li>
</ul>
<p>Altairâs grammar works best with <strong>long-form</strong> data, in which each row
corresponds to a single observation along with its metadata.</p>
<p>A concrete example will help in making this distinction more clear.
Consider a dataset consisting of stock prices of several companies over time.
The wide-form version of the data might be arranged as follows:</p>
<div class="highlight-python" id="data-rst-altair-source-5"><div class="highlight"><pre><span></span><span class="n">wide_form</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2007-10-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-11-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-12-01&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;AAPL&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">189.95</span><span class="p">,</span> <span class="mf">182.22</span><span class="p">,</span> <span class="mf">198.08</span><span class="p">],</span>
                          <span class="s1">&#39;AMZN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">89.15</span><span class="p">,</span> <span class="mf">90.56</span><span class="p">,</span> <span class="mf">92.64</span><span class="p">],</span>
                          <span class="s1">&#39;GOOG&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">707.00</span><span class="p">,</span> <span class="mf">693.00</span><span class="p">,</span> <span class="mf">691.48</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wide_form</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>             Date    AAPL   AMZN    GOOG
    0  2007-10-01  189.95  89.15  707.00
    1  2007-11-01  182.22  90.56  693.00
    2  2007-12-01  198.08  92.64  691.48
</pre></div>
</div>
<p>Notice that each row corresponds to a single time-stamp (here time is the
independent variable), while metadata for each observation
(i.e. company name) is stored within the column labels.</p>
<p>The long-form version of the same data might look like this:</p>
<div class="highlight-python" id="data-rst-altair-source-6"><div class="highlight"><pre><span></span><span class="n">long_form</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2007-10-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-11-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-12-01&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;2007-10-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-11-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-12-01&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;2007-10-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-11-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-12-01&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;company&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;AMZN&#39;</span><span class="p">,</span> <span class="s1">&#39;AMZN&#39;</span><span class="p">,</span> <span class="s1">&#39;AMZN&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;GOOG&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOG&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOG&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">189.95</span><span class="p">,</span> <span class="mf">182.22</span><span class="p">,</span> <span class="mf">198.08</span><span class="p">,</span>
                                     <span class="mf">89.15</span><span class="p">,</span>  <span class="mf">90.56</span><span class="p">,</span>  <span class="mf">92.64</span><span class="p">,</span>
                                    <span class="mf">707.00</span><span class="p">,</span> <span class="mf">693.00</span><span class="p">,</span> <span class="mf">691.48</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">long_form</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>             Date company   price
    0  2007-10-01    AAPL  189.95
    1  2007-11-01    AAPL  182.22
    2  2007-12-01    AAPL  198.08
    3  2007-10-01    AMZN   89.15
    4  2007-11-01    AMZN   90.56
    5  2007-12-01    AMZN   92.64
    6  2007-10-01    GOOG  707.00
    7  2007-11-01    GOOG  693.00
    8  2007-12-01    GOOG  691.48
</pre></div>
</div>
<p>Notice here that each row contains a single observation (i.e. price), along
with the metadata for this observation (the date and company name).
Importantly, the column and index labels no longer contain any useful metadata.</p>
<p>As mentioned above, Altair works best with this long-form data, because relevant
data and metadata are stored within the table itself, rather than within the
labels of rows and columns:</p>
<div class="highlight-python" id="data-rst-altair-source-7"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">long_form</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
  <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Date:T&#39;</span><span class="p">,</span>
  <span class="n">y</span><span class="o">=</span><span class="s1">&#39;price:Q&#39;</span><span class="p">,</span>
  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;company:N&#39;</span>
<span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-7">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-838ec4417e9a8df251f2031a5a48660b"}, "mark": "line", "encoding": {"color": {"type": "nominal", "field": "company"}, "x": {"type": "temporal", "field": "Date"}, "y": {"type": "quantitative", "field": "price"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-838ec4417e9a8df251f2031a5a48660b": [{"Date": "2007-10-01", "company": "AAPL", "price": 189.95}, {"Date": "2007-11-01", "company": "AAPL", "price": 182.22}, {"Date": "2007-12-01", "company": "AAPL", "price": 198.08}, {"Date": "2007-10-01", "company": "AMZN", "price": 89.15}, {"Date": "2007-11-01", "company": "AMZN", "price": 90.56}, {"Date": "2007-12-01", "company": "AMZN", "price": 92.64}, {"Date": "2007-10-01", "company": "GOOG", "price": 707.0}, {"Date": "2007-11-01", "company": "GOOG", "price": 693.0}, {"Date": "2007-12-01", "company": "GOOG", "price": 691.48}]}};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-7', spec, opt).catch(console.err);
  });
</script>
</div><p>Wide-form data can be similarly visualized using e.g. layering
(see <a class="reference internal" href="compound_charts.html#layer-chart"><span class="std std-ref">Layered Charts</span></a>), but it is far less convenient within Altairâs grammar.</p>
<p>If you would like to convert data from wide-form to long-form, there are two possible
approaches: it can be done as a preprocessing step using pandas, or as a transform
step within the chart itself. We will detail to two approaches below.</p>
<div class="section" id="converting-between-long-form-and-wide-form-pandas">
<span id="data-converting-long-form"></span><h3>Converting Between Long-form and Wide-form: Pandas<a class="headerlink" href="#converting-between-long-form-and-wide-form-pandas" title="Permalink to this headline">Â¶</a></h3>
<p>This sort of data manipulation can be done as a preprocessing step using <a class="reference external" href="http://pandas.pydata.org/">Pandas</a>,
and is discussed in detail in the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reshaping.html">Reshaping and Pivot Tables</a> section of the
Pandas documentation.</p>
<p>For converting wide-form data to the long-form data used by Altair, the <code class="docutils literal"><span class="pre">melt</span></code>
method of dataframes can be used. The first argument to <code class="docutils literal"><span class="pre">melt</span></code> is the column
or list of columns to treat as index variables; the remaining columns will
be combined into an indicator variable and a value variable whose names can
be optionally specified:</p>
<div class="highlight-python" id="data-rst-altair-source-8"><div class="highlight"><pre><span></span><span class="n">wide_form</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;price&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>             Date company   price
    0  2007-10-01    AAPL  189.95
    1  2007-11-01    AAPL  182.22
    2  2007-12-01    AAPL  198.08
    3  2007-10-01    AMZN   89.15
    4  2007-11-01    AMZN   90.56
    5  2007-12-01    AMZN   92.64
    6  2007-10-01    GOOG  707.00
    7  2007-11-01    GOOG  693.00
    8  2007-12-01    GOOG  691.48
</pre></div>
</div>
<p>For more information on the <code class="docutils literal"><span class="pre">melt</span></code> method, see the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.melt.html#pandas.DataFrame.melt">Pandas melt documentation</a>.</p>
<p>In case you would like to undo this operation and convert from long-form back
to wide-form, the <code class="docutils literal"><span class="pre">pivot</span></code> method of dataframes is useful.</p>
<div class="highlight-python" id="data-rst-altair-source-9"><div class="highlight"><pre><span></span><span class="n">long_form</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;price&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>    company        Date    AAPL   AMZN    GOOG
    0        2007-10-01  189.95  89.15  707.00
    1        2007-11-01  182.22  90.56  693.00
    2        2007-12-01  198.08  92.64  691.48
</pre></div>
</div>
<p>For more information on the <code class="docutils literal"><span class="pre">pivot</span></code> method, see the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html">Pandas pivot documentation</a>.</p>
</div>
<div class="section" id="converting-between-long-form-and-wide-form-fold-transform">
<h3>Converting Between Long-form and Wide-form: Fold Transform<a class="headerlink" href="#converting-between-long-form-and-wide-form-fold-transform" title="Permalink to this headline">Â¶</a></h3>
<p>If you would like to avoid data preprocessing, you can reshape your data using Altairâs
Fold Transform (see <a class="reference internal" href="transform/fold.html#user-guide-fold-transform"><span class="std std-ref">Fold Transform</span></a> for a full discussion).
With it, the above chart can be reproduced as follows:</p>
<div class="highlight-python" id="data-rst-altair-source-10"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">wide_form</span><span class="p">)</span><span class="o">.</span><span class="n">transform_fold</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AMZN&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOG&#39;</span><span class="p">],</span>
    <span class="n">as_</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Date:T&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;price:Q&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;company:N&#39;</span>
<span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-10">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-0262b56fd1a535ea9c867d2322ea5232"}, "mark": "line", "encoding": {"color": {"type": "nominal", "field": "company"}, "x": {"type": "temporal", "field": "Date"}, "y": {"type": "quantitative", "field": "price"}}, "transform": [{"fold": ["AAPL", "AMZN", "GOOG"], "as": ["company", "price"]}], "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-0262b56fd1a535ea9c867d2322ea5232": [{"Date": "2007-10-01", "AAPL": 189.95, "AMZN": 89.15, "GOOG": 707.0}, {"Date": "2007-11-01", "AAPL": 182.22, "AMZN": 90.56, "GOOG": 693.0}, {"Date": "2007-12-01", "AAPL": 198.08, "AMZN": 92.64, "GOOG": 691.48}]}};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-10', spec, opt).catch(console.err);
  });
</script>
</div><p>Notice that unlike the pandas <code class="docutils literal"><span class="pre">melt</span></code> function we must explicitly specify the columns
to be folded. The <code class="docutils literal"><span class="pre">as_</span></code> argument is optional, with the default being <code class="docutils literal"><span class="pre">[&quot;key&quot;,</span> <span class="pre">&quot;value&quot;]</span></code>.</p>
</div>
</div>
<div class="section" id="generated-data">
<span id="data-generated"></span><h2>Generated Data<a class="headerlink" href="#generated-data" title="Permalink to this headline">Â¶</a></h2>
<p>At times it is convenient to not use an external data source, but rather generate data for
display within the chart specification itself. The benefit is that the chart specification
can be made much smaller for generated data than for embedded data.</p>
<div class="section" id="sequence-generator">
<h3>Sequence Generator<a class="headerlink" href="#sequence-generator" title="Permalink to this headline">Â¶</a></h3>
<p>Here is an example of using the <a class="reference internal" href="generated/api/altair.sequence.html#altair.sequence" title="altair.sequence"><code class="xref py py-func docutils literal"><span class="pre">sequence()</span></code></a> function to generate a sequence of  <em>x</em>
data, along with a <a class="reference internal" href="transform/calculate.html#user-guide-calculate-transform"><span class="std std-ref">Calculate Transform</span></a> to compute <em>y</em> data.</p>
<div class="highlight-python" id="data-rst-altair-source-11"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="c1"># Note that the following generator is functionally similar to</span>
<span class="c1"># data = pd.DataFrame({&#39;x&#39;: np.arange(0, 10, 0.1)})</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">as_</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">transform_calculate</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sin(datum.x)&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x:Q&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y:Q&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-11">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"sequence": {"start": 0, "stop": 10, "step": 0.1, "as": "x"}}, "mark": "line", "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}, "transform": [{"calculate": "sin(datum.x)", "as": "y"}], "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json"};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-11', spec, opt).catch(console.err);
  });
</script>
</div></div>
<div class="section" id="graticule-generator">
<h3>Graticule Generator<a class="headerlink" href="#graticule-generator" title="Permalink to this headline">Â¶</a></h3>
<p>Another type of data that is convenient to generate in the chart itself is the latitude/longitude
lines on a geographic visualization, known as a graticule. These can be created using Altairâs
<a class="reference internal" href="generated/api/altair.graticule.html#altair.graticule" title="altair.graticule"><code class="xref py py-func docutils literal"><span class="pre">graticule()</span></code></a> generator function. Here is a simple example:</p>
<div class="highlight-python" id="data-rst-altair-source-12"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">graticule</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_geoshape</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">project</span><span class="p">(</span>
    <span class="s1">&#39;orthographic&#39;</span><span class="p">,</span>
    <span class="n">rotate</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-12">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"graticule": {"step": [15, 15]}}, "mark": {"type": "geoshape", "stroke": "black"}, "projection": {"rotate": [0, -45, 0], "type": "orthographic"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json"};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-12', spec, opt).catch(console.err);
  });
</script>
</div></div>
<div class="section" id="sphere-generator">
<h3>Sphere Generator<a class="headerlink" href="#sphere-generator" title="Permalink to this headline">Â¶</a></h3>
<p>Finally when visualizing the globe a sphere can be used as a background layer
within a map to represent the extent of the Earth. This sphere data can be
created using Altairâs <a class="reference internal" href="generated/api/altair.sphere.html#altair.sphere" title="altair.sphere"><code class="xref py py-func docutils literal"><span class="pre">sphere()</span></code></a> generator function. Here is an example:</p>
<div class="highlight-python" id="data-rst-altair-source-13"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="n">sphere_data</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">sphere</span><span class="p">()</span>
<span class="n">grat_data</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">graticule</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="n">background</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">sphere_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_geoshape</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;aliceblue&#39;</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">grat_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_geoshape</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="s1">&#39;naturalEarth1&#39;</span><span class="p">)</span>
</pre></div>
</div>

<div id="data-rst-altair-plot-13">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"data": {"sphere": true}, "mark": {"type": "geoshape", "fill": "aliceblue"}}, {"data": {"graticule": {"step": [15, 15]}}, "mark": {"type": "geoshape", "stroke": "lightgrey"}}], "projection": {"type": "naturalEarth1"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json"};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": true, "source": true, "export": true}
      };
      vegaEmbed('#data-rst-altair-plot-13', spec, opt).catch(console.err);
  });
</script>
</div></div>
</div>
<div class="section" id="geospatial-data">
<span id="data-geo-interface"></span><h2>Geospatial Data<a class="headerlink" href="#geospatial-data" title="Permalink to this headline">Â¶</a></h2>
<p>Working with geographical data in Altair is possible if the object contains a
<cite>__geo_interface__</cite> attribute. This attribute represents the geo_interface which is a
Python protocol for Geospatial Data. The protocol follows a GeoJSON-like structure to
store geo-spatial vector data.</p>
<p>To make working with Geospatial Data as similar as working with long-form structured data
the geo_interface is serialized in order to:
- make it be correctly interpreted by Altair
- provide users a similar experience as when working with tabular data such as Pandas.</p>
<p>Altair can interpret a spatial bounded entity (a Feature) or a list of Features
(FeatureCollection). In order for correct interpretation it is made sure that all records
contain a single geometry (one of Point, LineString, Polygon, MultiPoint,
MultiLineString, MultiPolygon, and GeometryCollection) and is stored as a Feature entity.</p>
<p>The most basic Feature is an entity that only contains a Geometry object. For example
a Polygon:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[[</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">]],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Often, the Feature contains also additional metadata next to the Geometry object.
The <cite>__geo_interface__</cite> provides two approaches to store metadata.
- Metadata stored as a dictionary within the key <cite>properties</cite> (so called properties
member). This properties member must exist in a valid Feature entity.
- Metada may be stored directly as foreign members on the top-level of the Feature.
There is no normative processing model for usage of this declaration.</p>
<p>Altair serializes the metadata from the properties in combination with the declared
geometry as Feature entities. The result of this approach is that the keys <cite>type</cite>
and <cite>geometry</cite> in the properties member will be overwritten if used.</p>
<p>So a <cite>__geo_interface__</cite> that is registered as such</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;xx&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bah&quot;</span><span class="p">:</span> <span class="s2">&quot;yy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;zz&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Example Feature&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Is serialized as such:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span>
    <span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;xx&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bah&quot;</span><span class="p">:</span> <span class="s2">&quot;yy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The nested <cite>âtypeâ: âzzâ</cite> in the properties member is overwritten by <cite>âtypeâ:âFeatureâ</cite>
and only the metadata stored in the properties member is serialized. Meaning that
foreign members and the commonly used identifier are not serialized.</p>
</div>
<div class="section" id="geopandas-vs-pandas">
<span id="data-geopandas-vs-pandas"></span><h2>GeoPandas vs Pandas<a class="headerlink" href="#geopandas-vs-pandas" title="Permalink to this headline">Â¶</a></h2>
<p>A <cite>GeoDataFrame</cite> is a <cite>DataFrame</cite> including a special column with spatial geometries.
The column-name containing the spatial geometries defaults to <cite>geometry</cite>. To directly
use a <cite>GeoDataFrame</cite> with Altair means in practice that only the column-name <cite>type</cite>
should be avoided.</p>
</div>
<div class="section" id="projections">
<span id="data-projections"></span><h2>Projections<a class="headerlink" href="#projections" title="Permalink to this headline">Â¶</a></h2>
<p>Altair works best when the Geospatial Data adopts the World Geodetic System 1984 as
its geographic coordinate reference system with units in decimal degrees.</p>
<p>Try to avoid putting projected data into Altair, but reproject your spatial data to
EPSG:4326 first.</p>
<p>If your data comes in a different projection (eg. with units in meters) and you donât
have the option to reproject the data, try using the project configuration
<cite>(type: âidentityâ, reflectYâ: True)</cite>. It draws the geometries in a cartesian grid
without applying a projection.</p>
</div>
<div class="section" id="winding-order">
<span id="data-winding-order"></span><h2>Winding order<a class="headerlink" href="#winding-order" title="Permalink to this headline">Â¶</a></h2>
<p>LineString, Polygon and MultiPolygon geometries contain coordinates in an order: lines
go in a certain direction, and polygon rings do too. The GeoJSON-like structure of the
__geo_interface__ recommends the right-hand rule winding order for Polygon and
MultiPolygons. Meaning that the exterior rings should be counterclockwise and interior
rings are clockwise. While it recommends the right-hand rule winding order, it does not
reject geometries that do not use the right-hand rule.</p>
<p>Altair does NOT follow the right-hand rule for geometries, but uses the left-hand rule.
Meaning that exterior rings should be clockwise and interior rings should be
counterclockwise.</p>
<p>If you face a problem regarding winding order, try to force the left-hand rule on your
data before usage in Altair using GeoPandas for example as such:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">shapely.ops</span> <span class="kn">import</span> <span class="n">orient</span> <span class="c1"># version &gt;=1.7a2</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">orient</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,))</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="encoding.html" class="btn btn-neutral float-right" title="Encodings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../gallery/wilkinson-dot-plot.html" class="btn btn-neutral" title="Wilkinson Dot Plot" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2019, Altair Developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'4.1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@5"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@4.8.1"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>